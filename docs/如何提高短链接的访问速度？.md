**测试目标**

- 模拟不同线程负载下的系统性能，评估系统的响应时间、吞吐量、错误率等关键指标。

**测试环境**

- 数据量：每次测试从某个初始值开始，逐步增加到 100万.
- 线程数梯度范围:
    1. 低负载：10、20、50、100
    2. 中等负载：200、300、400、500
    3. 高负载：600、700、800、900、1000
    4. 极限负载：1500、2000、2500

**测试指标**

| 指标名称    | 描述                      |
|---------|-------------------------|
| 样本      | 测试中发送的请求数量              |
| 平均值     | 平均响应时间（单位：毫秒）           |
| 90% 百分位 | 90% 的用户请求响应时间（单位：毫秒）    |
| 错误率     | 出现错误的请求数占总请求数的百分比       |
| 最小响应时间  | 最小响应时间（单位：毫秒）           |
| 最大响应时间  | 最大响应时间（单位：毫秒）           |
| 吞吐量     | 每秒完成的请求数（单位：TPS）        |
| 接收数据量   | 每秒从服务器接收的数据量（单位：KB）     |
| 发送数据量   | 每秒从客户端发送到服务器的数据量（单位：KB） |

## v1.0 [实现基础功能](https://github.com/gaotianchi/shorten/releases/tag/v1.0)

| 线程数 | 样本    | 最小响应时间 | 平均值   | 99% 百分位 | 最大响应时间 | 吞吐量  | 错误率 | 接收数据量 | 发送数据量 |
|-----|-------|--------|-------|---------|--------|------|-----|-------|-------|
| 10  | 10000 | 220    | 636   | 799     | 969    | 15.5 | 0   | 4.42  | 1.92  |
| 20  | 10000 | 221    | 1038  | 1527    | 1800   | 19.1 | 0   | 5.43  | 2.35  |
| 50  | 6897  | 383    | 2580  | 3361    | 3908   | 19.3 | 0   | 5.48  | 2.38  |
| 100 | 10000 | 505    | 5157  | 6159    | 6963   | 19.2 | 0   | 5.48  | 2.38  |
| 200 | 10000 | 1257   | 10653 | 12374   | 15725  | 18.6 | 0   | 5.29  | 2.30  |
| 300 | 10200 | 616    | 16273 | 19691   | 25707  | 18.2 | 0   | 5.18  | 2.25  |

## v1.1 [添加单机 REDIS 缓存层](https://github.com/gaotianchi/shorten/releases/tag/v1.1)

考虑到真实场景下应用程序接收到的热点流量占总流量的大约 10%，所以在测压程序中将 90% 的流量导入指定的 1000 条热点数据中。

| 线程数 | 样本    | 最小响应时间 | 平均值  | 99% 百分位 | 最大响应时间 | 吞吐量  | 错误率 | 接收数据量 | 发送数据量 |
|-----|-------|--------|------|---------|--------|------|-----|-------|-------|
| 10  | 10605 | 1      | 112  | 678     | 819    | 74.3 | 0   | 18.77 | 9.07  |
| 20  | 10000 | 1      | 192  | 1307    | 1829   | 98.1 | 0   | 24.8  | 11.99 |
| 50  | 10000 | 1      | 493  | 3471    | 4419   | 93.9 | 0   | 23.74 | 11.47 |
| 100 | 10000 | 1      | 1005 | 6642    | 8480   | 91.3 | 0   | 23.11 | 11.16 |

添加 REDIS 缓存层后程序的吞吐量明显提升，在预热充分的情况下吞吐量可以达到 200 以上。上述每次变动线程数量之前都会清除上一次的缓存数据。